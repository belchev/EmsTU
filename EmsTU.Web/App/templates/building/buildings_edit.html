<div class="container page-container">

  <div class="page-view-CT">

    <div class="navbar" style="position: fixed; top: 40px; width: 948px; z-index: 1000;" data-bind="visible: !_isInDialog()">
      <div class="navbar-inner">
        <div class="container nav-container">
          <ul class="nav">
            <li data-bind="visible: !_inEditMode()">
              <a data-bind="click: _enterEditMode" href="#">
                <i class="icon-edit"></i><span>&nbsp;Редакция</span>
              </a>
            </li>
            <li data-bind="visible: _inEditMode()">
              <a data-bind="click: _save" href="#">
                <i class="icon-ok"></i><span>&nbsp;Запис</span>
              </a>
            </li>
            <li data-bind="visible: _inEditMode()">
              <a data-bind="click: _exitEditMode" href="#">
                <i class="icon-remove"></i><span>&nbsp;Отказ</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <form class="well" data-bind="with: _building">

      <div class="alert alert-error" data-bind="visible: errorString(), text: errorString">
      </div>

      <h2 data-bind="text: name" style="text-align: center;"></h2>

      <ul class="nav nav-tabs">
        <li data-bind="css: { 'active': $parent._currentTab() === 'buildingInfo' }">
          <a data-toggle="tab" data-target="#buildingInfo" data-bind="click: function () { $parent._innerNavigation('buildingInfo'); }">Инфо</a>
        </li>
        <li data-bind="css: { 'active': $parent._currentTab() === 'buildingMenu' }">
          <a data-toggle="tab" data-target="#buildingMenu" data-bind="click: function () { $parent._innerNavigation('buildingMenu'); }">Меню</a>
        </li>
      </ul>

      <div class="tabbable">
        <div class="tab-content">
          <div class="tab-pane" id="buildingInfo" data-bind="css: { 'active': $parent._currentTab() === 'buildingInfo' }">


            <div class="row">
              <div class="span5" data-bind="css: { 'error': ($parent._showErrors() && $parent._nameError()) || $parent._nameError() }">Име:</div>
              <div class="span5">Слоган:</div>
            </div>
            <div class="row">
              <div class="span5" data-bind="css: { 'error': ($parent._showErrors() && $parent._nameError()) || $parent._nameError() }">
                <input type="text" class="input-xlarge" data-bind="value: name, enable: $parent._inEditMode()">
              </div>
              <div class="span5">
                <input type="text" class="input-xlarge" data-bind="value: slogan, enable: $parent._inEditMode()">
              </div>
            </div>

            <div class="row">
              <div class="span5">Уеб сайт:</div>
              <div class="span5">Работно време:</div>
            </div>
            <div class="row">
              <div class="span5">
                <input type="text" class="input-xlarge" data-bind="value: webSite, enable: $parent._inEditMode()">
              </div>
              <div class="span5">
                <input type="text" class="input-xlarge" data-bind="value: workingTime, enable: $parent._inEditMode()">
              </div>
            </div>

            <br />

            <div class="row">
              <div class="span5" data-bind="css: { 'error': $parent._showErrors() && settlementId.hasErrors() }">
                <label class="control-label">Област:</label>
              </div>
              <div class="span5" data-bind="css: { 'error': $parent._showErrors() && settlementId.hasErrors() }">
                <label class="control-label">Община:</label>
              </div>
            </div>
            <div class="row">
              <div class="span5" style="margin-bottom: 5px;" data-bind="css: { 'error': $parent._showErrors() && settlementId.hasErrors() }">
                <div class="dropdown-container span4" data-bind="nomenclatureContext: { nomenclatureKey: 'districts', value: districtId, idProperty: 'districtId' }">
                  <select class="span4" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, value: nomenclatureContext.value, optionsText: 'name', optionsValue: 'districtId', chosenOptions: { allow_single_deselect: true } }"></select>
                  <div class="app-icon-chosen-loading" data-bind="visible: nomenclatureContext.loading"></div>
                </div>
              </div>

              <div class="span5" style="margin-bottom: 5px;" data-bind="css: { 'error': $parent._showErrors() && settlementId.hasErrors() }">
                <div class="dropdown-container span4" data-bind="childNomenclatureContext: { nomenclatureKey: 'municipalities', value: municipalityId, idProperty: 'municipalityId', parent: districtId }">
                  <select class="span4" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, value: nomenclatureContext.value, optionsText: 'name', optionsValue: 'municipalityId', chosenOptions: { allow_single_deselect: true } }"></select>
                  <i data-bind="visible: nomenclatureContext.loading"></i>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="span5" data-bind="css: { 'error': $parent._showErrors() && settlementId.hasErrors() }">
                <label class="control-label">Населено място:</label>
              </div>
              <div class="span5" data-bind="css: { 'error': ($parent._showErrors() && $parent._addressError()) || $parent._addressError() }">
                <label class="control-label">Адрес:</label>
              </div>
            </div>
            <div class="row">
              <div class="span5" style="margin-bottom: 5px;" data-bind="css: { 'error': $parent._showErrors() && settlementId.hasErrors() }">
                <div class="dropdown-container span4" data-bind="childNomenclatureContext: { nomenclatureKey: 'settlements', value: settlementId, idProperty: 'settlementId', parent: municipalityId }">
                  <select class="span4" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, value: nomenclatureContext.value, optionsText: 'name', optionsValue: 'settlementId', chosenOptions: { allow_single_deselect: true } }"></select>
                  <i data-bind="visible: nomenclatureContext.loading"></i>
                </div>
              </div>
              <div class="span5" data-bind="css: { 'error': ($parent._showErrors() && $parent._addressError()) || $parent._addressError() }">
                <input type="text" class="input-xlarge" data-bind="value: address, enable: $parent._inEditMode()">
              </div>
            </div>

            <br />

            <div class="row">
              <div class="span5">Лице за контакт:</div>
              <div class="span5" data-bind="css: { 'error': ($parent._showErrors() && $parent._contactPhoneError()) || $parent._contactPhoneError() }">Телефон за контакт:</div>
            </div>
            <div class="row">
              <div class="span5">
                <input type="text" class="input-xlarge" data-bind="value: contactName, enable: $parent._inEditMode()">
              </div>
              <div class="span5" data-bind="css: { 'error': ($parent._showErrors() && $parent._contactPhoneError()) || $parent._contactPhoneError() }">
                <input type="text" class="input-xlarge" data-bind="value: contactPhone, enable: $parent._inEditMode()">
              </div>
            </div>

            <div class="row">
              <div class="span2">Места вътре:</div>
              <div class="span3">Места вън:</div>
              <div class="span2">Ценови клас:</div>
            </div>
            <div class="row">
              <div class="span2 input-append">
                <input type="text" class="input-small" data-bind="value: seatsInside, enable: $parent._inEditMode()"><span class="add-on">бр.</span>
              </div>
              <div class="span3 input-append">
                <input type="text" class="input-small" data-bind="value: seatsOutside, enable: $parent._inEditMode()"><span class="add-on">бр.</span>
              </div>
              <div class="span2 input-append">
                <input type="text" class="input-small" data-bind="value: price, enable: $parent._inEditMode()"><span class="add-on">лв.</span>
              </div>
            </div>

            <br />

            <div class="row">
              <div class="span5">
                <label class="control-label">Тип заведение:</label>
              </div>
              <div class="span5">
                <label class="control-label">Тип кухня:</label>
              </div>
            </div>
            <div class="row">
              <div class="span5" style="margin-bottom: 10px;">
                <div class="dropdown-container span4" data-bind="multiNomenclatureContext: { nomenclatureKey: 'buildingTypes', value: buildingTypes, idProperty: 'nomId' }">
                  <select class="span4" multiple="multiple" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, selectedOptions: nomenclatureContext.value, optionsText: 'name', optionsValue: 'nomId', chosenOptions: { allow_single_deselect: true } }"></select>
                  <div class="app-icon-chosen-loading" data-bind="visible: nomenclatureContext.loading"></div>
                </div>
              </div>
              <div class="span5" style="margin-bottom: 10px;">
                <div class="dropdown-container span4" data-bind="multiNomenclatureContext: { nomenclatureKey: 'kitchenTypes', value: kitchenTypes, idProperty: 'nomId' }">
                  <select class="span4" multiple="multiple" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, selectedOptions: nomenclatureContext.value, optionsText: 'name', optionsValue: 'nomId', chosenOptions: { allow_single_deselect: true } }"></select>
                  <div class="app-icon-chosen-loading" data-bind="visible: nomenclatureContext.loading"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="span5">
                <label class="control-label">Тип музика:</label>
              </div>
              <div class="span5">
                <label class="control-label">Повод:</label>
              </div>
            </div>
            <div class="row">
              <div class="span5" style="margin-bottom: 10px;">
                <div class="dropdown-container span4" data-bind="multiNomenclatureContext: { nomenclatureKey: 'musicTypes', value: musicTypes, idProperty: 'nomId' }">
                  <select class="span4" multiple="multiple" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, selectedOptions: nomenclatureContext.value, optionsText: 'name', optionsValue: 'nomId', chosenOptions: { allow_single_deselect: true } }"></select>
                  <div class="app-icon-chosen-loading" data-bind="visible: nomenclatureContext.loading"></div>
                </div>
              </div>
              <div class="span5" style="margin-bottom: 10px;">
                <div class="dropdown-container span4" data-bind="multiNomenclatureContext: { nomenclatureKey: 'occasionTypes', value: occasionTypes, idProperty: 'nomId' }">
                  <select class="span4" multiple="multiple" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, selectedOptions: nomenclatureContext.value, optionsText: 'name', optionsValue: 'nomId', chosenOptions: { allow_single_deselect: true } }"></select>
                  <div class="app-icon-chosen-loading" data-bind="visible: nomenclatureContext.loading"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="span5">
                <label class="control-label">Начин на плащане:</label>
              </div>
              <div class="span5">
                <label class="control-label">Екстри:</label>
              </div>
            </div>
            <div class="row">
              <div class="span5" style="margin-bottom: 10px;">
                <div class="dropdown-container span4" data-bind="multiNomenclatureContext: { nomenclatureKey: 'paymentTypes', value: paymentTypes, idProperty: 'nomId' }">
                  <select class="span4" multiple="multiple" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, selectedOptions: nomenclatureContext.value, optionsText: 'name', optionsValue: 'nomId', chosenOptions: { allow_single_deselect: true } }"></select>
                  <div class="app-icon-chosen-loading" data-bind="visible: nomenclatureContext.loading"></div>
                </div>
              </div>
              <div class="span5" style="margin-bottom: 10px;">
                <div class="dropdown-container span4" data-bind="multiNomenclatureContext: { nomenclatureKey: 'extras', value: extras, idProperty: 'nomId' }">
                  <select class="span4" multiple="multiple" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, selectedOptions: nomenclatureContext.value, optionsText: 'name', optionsValue: 'nomId', chosenOptions: { allow_single_deselect: true } }"></select>
                  <div class="app-icon-chosen-loading" data-bind="visible: nomenclatureContext.loading"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="span2" data-bind="css: { 'error': $parent._showErrors() && $parent._isActive.hasErrors() }">
                <label class="control-label">Активен:</label>
              </div>
              <div class="span3">
                <label class="control-label" data-bind="css: { 'error': $parent._showErrors() && $parent._isDeleted.hasErrors() }, visible: isAdmin">Изтрит:</label>
              </div>
              <div class="span5">
                <label class="control-label">Лого:</label>
              </div>
            </div>
            <div class="row">
              <div class="span2" data-bind="css: { 'error': $parent._showErrors() && $parent._isActive.hasErrors() }">
                <div class="dropdown-container span2" data-bind="nomenclatureContext: { nomenclatureKey: 'yesNoOptions', value: $parent._isActive, idProperty: 'value' }">
                  <select class="" style="width: 134px;" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, value: nomenclatureContext.value, optionsText: 'name', optionsValue: 'value', chosenOptions: { allow_single_deselect: true } }"></select>
                  <div class="app-icon-chosen-loading" data-bind="visible: nomenclatureContext.loading"></div>
                </div>
              </div>
              <div class="span3">
                <div data-bind="css: { 'error': $parent._showErrors() && $parent._isDeleted.hasErrors() }, visible: isAdmin">
                  <div class="dropdown-container span2" data-bind="nomenclatureContext: { nomenclatureKey: 'yesNoOptions', value: $parent._isDeleted, idProperty: 'value' }">
                    <select class="" style="width: 134px;" data-bind="chosen: { disabled: !$parents[1]._inEditMode(), options: nomenclatureContext.options, value: nomenclatureContext.value, optionsText: 'name', optionsValue: 'value', chosenOptions: { allow_single_deselect: true } }"></select>
                    <div class="app-icon-chosen-loading" data-bind="visible: nomenclatureContext.loading"></div>
                  </div>
                </div>
              </div>
              <div class="span5">
                <div data-bind="visible: hasLogo()" style="float: left; margin-right: 5px;">
                  <img data-bind="attr: { src: imagePath() }">
                </div>
                <div style="float: left;">
                  <button class="btn" data-bind="click: $parent._deleteFile, visible: hasLogo(), enable: $parent._inEditMode()"><i class="icon-remove"></i>&nbsp; изтрий</button>
                  <button class="btn" data-bind="visible: !hasLogo(), enable: $parent._inEditMode(), click: $parent._chooseFile"><i class="icon-plus"></i>&nbsp; добави</button>
                </div>
              </div>
            </div>

            <br />

            <div class="row">
              <div class="span9">
                <label class="control-label">Доп. информация:</label>
              </div>
            </div>
            <div class="row">
              <div class="span9">
                <textarea rows="6" class="span9" data-bind="value: info, enable: $parent._inEditMode()"></textarea>
              </div>
            </div>

          </div>
          <div class="tab-pane" id="buildingMenu" data-bind="css: { 'active': $parent._currentTab() === 'buildingMenu' }">
            <div data-bind="with: $parent._currMenuCat" style="width: 550px; float: left;">
              <div>
                <h3 style="line-height: 16px;" data-bind="text: name"></h3>
                <hr />
              </div>

              <!-- ko if: $parents[1]._inMenuEditMode() -->
              <div data-bind="with: $parents[1]._currMenu">
                <div class="row">
                  <div class="span4">Име:</div>
                  <div class="span2" style="width: 100px;">Грамаж:</div>
                  <div class="span2" style="width: 100px;">Цена:</div>
                </div>
                <div class="row">
                  <div class="span4">
                    <input type="text" class="input-xlarge" data-bind="value: name">
                  </div>
                  <div class="span1 input-append" style="width: 100px;">
                    <input type="text" class="input-mini" data-bind="intValue: size"><span class="add-on">гр.</span>
                  </div>
                  <div class="span1 input-append" style="width: 100px;">
                    <input type="text" class="input-mini" data-bind="decimalValue: price"><span class="add-on">лв.</span>
                  </div>
                </div>
                <div class="row">
                  <div class="span4">Състав:</div>
                  <div class="span2">Снимка:</div>
                </div>
                <div class="row">
                  <div class="span4">
                    <textarea rows="3" class="input-xlarge span4" data-bind="value: info"></textarea>
                  </div>
                  <div class="span2"></div>
                </div>
                <button class="btn" data-bind="click: $parents[2]._exitMenuEditMode"><i class="icon-ok"></i>&nbsp; Запази</button>
              </div>
              <!-- /ko-->

              <!-- ko if: !$parents[1]._inMenuEditMode() -->
              <table class="table table-list">
                <tbody data-bind="foreach: menus">
                  <tr data-bind="css: { 'del': isDeleted() }">
                    <td style="width: 55px; text-align: center;"></td>
                    <td>
                      <b><span data-bind="text: name"></span></b><br />
                      <i><span data-bind="text: info"></span></i>

                    </td>
                    <td style="vertical-align: bottom; width: 100px;"><i><span data-bind="text: size"></span> гр .. <span data-bind="  text: price"></span> лв</i></td>
                    <td style="text-align: right;">
                      <!-- ko if: !isDeleted() -->
                        <button class="btn btn-mini" data-bind="click: $parents[2]._deleteMenuItem, enable: $parents[2]._inEditMode()"><i class="icon-remove"></i></button>
                      <!-- /ko-->
                       <!-- ko if: isDeleted() -->
                        <button class="btn btn-mini" data-bind="click: $parents[2]._unDeleteMenuCat, enable: $parents[2]._inEditMode()"><i class="icon-plus"></i></button>
                      <!-- /ko-->
                      <br />
                      <button class="btn btn-mini" data-bind="click: $parents[2]._enterMenuEditMode, enable: $parents[2]._inEditMode()"><i class="icon-edit"></i></button>
                    </td>
                  </tr>
                </tbody>
                <tbody style="border-top: 1px solid #dddddd;">
                  <tr>
                    <td colspan="4" style="text-align: right; border: 0px;">
                      <button class="btn btn-mini" data-bind="click: $parents[1]._addMenuItem, enable: $parents[1]._inEditMode()"><i class="icon-plus"></i></button>
                    </td>
                  </tr>
                </tbody>

              </table>

              <!-- /ko-->


            </div>

            <div class="building-edit-right">
              <div style="text-align: center;">
                <h3>Меню</h3>
                <hr />
              </div>

              <div class="menu-cat">
                <div data-bind="foreach: menuCategories">
                  <!-- ko if: !$parents[1]._inEditMode() -->
                  <a data-bind="click: $parents[1]._loadSingleMenuCat" style="cursor: pointer;">
                    <h4 data-bind="text: name"></h4>
                  </a>
                  <!-- /ko-->

                  <!-- ko if: $parents[1]._inEditMode() -->
                  <div data-bind="if: !isDeleted()">
                    <div class="input-append" style="margin-bottom: 1px;">
                      <input type="text" class="input-large" data-bind="value: name">
                      <button class="btn" data-bind="click: $parents[1]._deleteMenuCat"><i class="icon-remove"></i></button>
                    </div>
                  </div>
                  <div data-bind="if: isDeleted()">
                    <div class="input-append" style="margin-bottom: 1px;">
                      <input type="text" class="input-large" data-bind="value: name" style="background-color: indianred;">
                      <button class="btn" data-bind="click: $parents[1]._unDeleteMenuCat"><i class="icon-plus"></i></button>
                    </div>
                  </div>
                  <!-- /ko-->

                </div>
                <br />


                <button class="btn" data-bind="click: $parent._addMenuCat, enable: $parent._inEditMode"><i class="icon-plus"></i>&nbsp; добави категория</button>
              </div>



            </div>

            <div style="clear: both;"></div>

          </div>
        </div>
      </div>
    </form>
  </div>
</div>
